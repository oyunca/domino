function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}define("dpz.utag.orderEvents",["dpz.config"],function(C){function P(){return site.func.customerLoggedIn()||site.func.customerSemiLoggedIn()?"LoggedIn":"not_logged"}function h(){return jsDPZ.app.catalog.getCatalog()}var y={Cash:"Cash",DoorCredit:"DoorCredit",DoorDebit:"DoorDebit",StoreDebit:"StoreDebit",StoreCredit:"StoreCredit",openpay:"OpenPay",WOW:"WOW",ValesCDMX:"ValesCdmx",VisaCybersource:"VisaCybersource"},s=jsDPZ.app.order.getOrder,a=function(e){var t=0<arguments.length&&void 0!==e?e:"";if(t)return h().getProduct(t)};function A(e){var t=0<arguments.length&&void 0!==e?e:"";if(t){var r,n,o=v(t);return o&&(r=a(o.data.ProductCode)),r&&(n=l(r.data.ProductType,o.data.SizeCode)),[o,r,n||{Name:""}]}return[]}function b(e,t){var D=1<arguments.length&&void 0!==t&&t;return(0<arguments.length&&void 0!==e?e:[]).map(function(e){var t=e||{},r=t.Qty,n=t.Code,o=t.Price,a=_slicedToArray(A(n),3),i=a[0],u=a[1],d=a[2],c=(null==i?void 0:i.data)||{},l=c.Name,s=c.ProductCode,y=c.Price,m=(null==u?void 0:u.data)||{},v=m.Name,p=_slicedToArray(function(e,t){var r;if(!e||!t)return[];var n,o=h().getCategoryData("Food",e)||{};return o.Products.length&&o.Products.includes(t)?[e]:(o.Categories.length&&(n=o.Categories.find(function(e){return!!e.Products.includes(t)})),[e,null===(r=n)||void 0===r?void 0:r.Code])}(m.ProductType,s),2),g=p[0],f=void 0===g?"":g,_=p[1];if(i&&u&&d)return{item_name:D?v:l||n,item_id:n,price:o||y,item_brand:"Dominos",item_category:f,item_category2:void 0===_?"":_,item_variant:d.Name,quantity:r}})}function m(e){return(0<arguments.length&&void 0!==e?e:[]).reduce(function(e,t){if(t){if(t.Price)return e+t.Price*t.Qty;var r=_slicedToArray(A(t.Code),1)[0];if(r&&r.data)return e+(Number(r.data.Price)||0)*(t.Qty||0)}return e},0)}function n(d){return function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.couponCode,n=void 0===r?"":r,o=t.couponAddedAt,a=void 0===o?"":o,i=t.couponAddedMethod,u=void 0===i?"":i;d(null,{event_name:"Coupon Added",event_label:n}),d(null,{event_name:"add_coupon",coupon:n,add_method:u,add_location:a,login_status:P()})}}function o(r){return function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).couponCode;r(null,{event_name:"Coupon Removed",event_label:void 0===t?"":t})}}function i(l){return function(e){var t,r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})||{},n=r.variantCode,o=void 0===n?"":n,a=r.quantity,i=s().data,u=i.Details,d=m((u||{}).Variants),c=b([{Qty:a,Code:o}],!0);l(null,{event_name:"add_to_cart",category:"ecommerce",delivery_type:i.Details.ServiceMethod,order_timing:jsDPZ.util.empty(i.Details.OrderDateTime)?"Now":"Later",store_number:i.Details.StoreID,ecommerce:{currency:C.getMarketProperty("thirdParty").googleAnalyticsCurrencyCode,value:(null===(t=i.Details.Amounts)||void 0===t?void 0:t.Payment)||d,items:c},login_status:P()})}}function u(l){return function(e,t){if(t){var r=t||{},n=r.variantCode,o=void 0===n?"":n,a=r.quantity,i=s().data,u=i.Details,d=m((u||{}).Variants),c=b([{Qty:a,Code:o}],!0);l(null,{event_name:"remove_from_cart",delivery_type:i.Details.ServiceMethod,order_timing:jsDPZ.util.empty(i.Details.OrderDateTime)?"Now":"Later",store_number:i.Details.StoreID,ecommerce:{currency:C.getMarketProperty("thirdParty").googleAnalyticsCurrencyCode,value:i.Details.Amounts.Payment||d,items:c},login_status:P()})}}}function d(o){return function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"").id,r=void 0===t?"":t,n=(jsDPZ.app.order.getOrder().data.Details.Variants.find(function(e){return e.ID===r})||{}).Code;o(null,{event_name:"Product Updated",event_label:v(void 0===n?"":n)})}}function c(s){return function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=((2<arguments.length&&void 0!==arguments[2]?arguments[2]:{})||{}).Details,n=(void 0===r?{}:r)||{},o=n.Amounts,a=void 0===o?{}:o,i=n.Coupons,u=n.Variants,d=void 0===u?[]:u,c=(void 0===i?[]:i).map(function(e){return e.Code}).join(","),l=b(d,!0);s(null,{event_name:"add_payment_info",ecommerce:{coupon:c,currency:C.getMarketProperty("thirdParty").googleAnalyticsCurrencyCode,value:a.Payment,items:l},payment_type:function(e){return y[e]||e}(t.Payment_Type),login_status:P(),add_payment_status:"Success"})}}var l=function(e,t){var r=0<arguments.length&&void 0!==e?e:"",n=1<arguments.length&&void 0!==t?t:"";if(r&&n)return h().getSizesData(r,n)},v=function(e){var t=0<arguments.length&&void 0!==e?e:"";return h().getVariant(t)};return{init:function(e){function t(){try{e.apply(void 0,arguments)}catch(e){console.error(e)}}var r={"/order/variant/delete/":u(t),"/order/variant/new/":i(t),"/order/variant/update/":d(t),"/order/coupon/delete/":o(t),"/order/coupon/add/":n(t),"/cart/view/":function(y){return function(){var e=(jsDPZ.app.order.getOrder().data||{}).Details||{},t=e.Variants,r=void 0===t?[]:t,n=e.Coupons,o=void 0===n?[]:n,a=e.StoreID,i=e.ServiceMethod,u=e.OrderDateTime,d=(e.Amounts||{}).Menu,c=m(r),l=b(r),s=o.map(function(e){return e.Code}).join(",");y(null,{event_name:"view_cart",login_status:P(),delivery_type:i,order_timing:jsDPZ.util.empty(u)?"Now":"Later",store_number:a,ecommerce:{currency:dpz.config.getMarketProperty("thirdParty").googleAnalyticsCurrencyCode,value:d||c,items:l},coupon:s})}}(t),"paymentPage.load":function(i){return function(){var e=jsDPZ.app.order.getOrder().data,t=jsDPZ.app.customer.getCustomer().data,r=(e.Details||{}).Variants,n=m(r),o=b(r),a=e.Details.Coupons.map(function(e){return e.Code}).join(",");i(null,{event_name:"begin_checkout",is_loyalty_customer:"INACTIVE"!==t.Loyalty.AccountStatus,delivery_type:e.Details.ServiceMethod,order_timing:jsDPZ.util.empty(e.Details.OrderDateTime)?"Now":"Later",store_number:e.Details.StoreID,coupon:a,ecommerce:{value:e.Details.Amounts.Payment||n,currency:dpz.config.getMarketProperty("thirdParty").googleAnalyticsCurrencyCode,items:o},login_status:P()})}}(t),"/order/complete/":function(D){return function(){var e=$.extend(!0,{},jsDPZ.util.htmlEscape(site.data.lastOrder));if(0!==Object.keys(e).length){var t=jsDPZ.app.customer.getCustomer().data,r=(e||{}).Details,n=(void 0===r?{}:r)||{},o=n.Amounts,a=void 0===o?{}:o,i=n.Coupons,u=n.DeliveryFee,d=n.OrderID,c=n.OrderDateTime,l=n.Payments,s=void 0===l?[]:l,y=n.ServiceMethod,m=n.StoreID,v=n.Variants,p=void 0===v?[]:v,g=(void 0===i?[]:i).map(function(e){return e.Code}).join(","),f=s.map(function(e){return e.Type}).join(","),_=b(p,!0);D(null,{event_name:"purchase",is_loyalty_customer:"INACTIVE"!==t.Loyalty.AccountStatus,delivery_type:y,order_timing:jsDPZ.util.empty(c)?"Now":"Later",store_number:m,login_status:P(),pickup_time:c||"",ecommerce:{coupon:g,transaction_id:d,payment_type:f,value:a.Payment,tax:a.Tax,shipping:u,currency:C.getMarketProperty("thirdParty").googleAnalyticsCurrencyCode,items:_}})}}}(t),"/order/payment/add/":c(t),customerLogout:function(e){return function(){e(null,{event_name:"signed_out"})}}(t)};Object.keys(r).forEach(function(e){$(document).on(e,r[e])})},createOnCouponAdded:n,createOnCouponRemoved:o,createOnProductAdded:i,createOnProductRemoved:u,createOnProductUpdated:d,getLoggedInStatus:P}});