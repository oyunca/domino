function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,n,a=[],s=!0,i=!1;try{for(t=t.call(e);!(s=(o=t.next()).done)&&(a.push(o.value),!r||a.length!==r);s=!0);}catch(e){i=!0,n=e}finally{try{s||null==t.return||t.return()}finally{if(i)throw n}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}define("dpz.orderHistory",["dpz.orderHistory.message","simplr"],function(e,t){var r=e.getHasMessage,o=e.getHasSeenOrderHistoryMessage,n=e.renderMessage,a=e.setHasSeenOrderHistoryMessage;return{getHasMessage:r,getHasSeenOrderHistoryMessage:o,getOrderHistory:function(e){return function(e){var s=jsDPZ.app.customer.getCustomer(),i=s.CustomerID||site.storage.load("CID"),r=dpz.market.activeLanguageCode||document.querySelector("html").getAttribute("lang")||"en",t=dpz.customer.isProfiled(),o=dpz.loyalty.loyaltyIsOk();return s.fetchOrderHistory(_objectSpread({customerID:i,lang:r,loggedIn:t,loyaltyIsActive:o},e)).then(function(e){var r=_slicedToArray(Array.isArray(e)?e:[e],1)[0],t=r.customerOrders,o=void 0===t?[]:t,n=r.easyOrder,a=s.data.Session;return a.EasyOrder=n,a.hasEasyOrder=!!n,a.RecentOrderCount=o.length,i||$("#homeWrapper").addClass("is-anon").removeClass("is-profiled"),site.sessionTools.save().then(function(){return r})})}(e).catch(function(e){jsDPZ.topic("fetchOrders.error").publish(e);var r=site.func.buildURL({url:"#!/customer/logout/"});t.controller.mRouteAndExecute(r)}).always(function(){return $(document).trigger("/customer/profile/login/",jsDPZ.app.customer.getCustomer())})},renderMessage:n,setHasSeenOrderHistoryMessage:a,setLocalStoreData:function(o,e){var n=1<arguments.length&&void 0!==e?e:{};return $.Deferred(function(e){var r=e.resolve,t=e.reject;o&&site.isHomepage?jsDPZ.ajax.menu(_objectSpread(_objectSpread({},n),{},{StoreID:o.order.StoreID,includeAssets:killConfig.isMarketEnabled("wamImages")})).then(function(e){jsDPZ.app.catalog.setCatalog(e),r()}).fail(t):r()})}}});