function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a=[],i=!0,c=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(a.push(n.value),!r||a.length!==r);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(c)throw o}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}define("dpz.wow",["dpz.config","dpz.customer","dpz.template"],function(e,r,a){function i(){return o("profile").wowPlusEnabled}function c(){return new Promise(function(e,r){i()?jsDPZ.ajax.createAccountForWallet({provider:d}).then(e).fail(r):r(new Error(p))})}function t(){return new Promise(function(e,r){i()?jsDPZ.ajax.getAccountForWallet({provider:d}).then(e).fail(r):r(new Error(p))})}function n(t){return new Promise(function(e,r){i()?jsDPZ.ajax.isStoreEnabledForWallet({provider:d,storeId:t}).then(e).fail(function(){return e({enabled:!1})}):r(new Error(p))})}function u(e){var r=(0<arguments.length&&void 0!==e?e:{}).showPrompt,t=void 0===r||r;return new Promise(function(e){i()?jsDPZ.ajax.setProviderPreferences({provider:d,data:{showPrompt:t}}).then(e).fail(e):e()})}var o=e.getMarketProperty,l=r.userStatus,s=r.getStatus,f=a.getTranslateContextValue,d="WOW",p="Wow+ is disabled",m={ACCOUNT_ACTIVE:"ACCOUNT_ACTIVE",ACCOUNT_CREATION_FAILED:"ACCOUNT_CREATION_FAILED",ACCOUNT_NOT_FOUND:"ACCOUNT_NOT_FOUND",ACCOUNT_SUSPENDED:"ACCOUNT_SUSPENDED",EMAIL_SENDING_FAILED:"EMAIL_SENDING_FAILED",EMAIL_VERIFICATION_FAILED:"EMAIL_VERIFICATION_FAILED",EMAIL_VERIFICATION_PENDING:"EMAIL_VERIFICATION_PENDING",SERVER_ERROR:"SERVER_ERROR"};return{accountStatuses:m,getAccountDetails:t,isStoreEnabledForWallet:n,isWowActive:i,isWowPlusPromotionApplicable:function(e){var r=e.storeId;return new Promise(function(a){if(!i()||s()===l.ANONYMOUS)return a(!1);Promise.all([n(r),new Promise(function(e){i()?jsDPZ.ajax.getProviderPreferences({provider:d}).then(e).fail(function(){return e({showPrompt:!1})}):e({showPrompt:!1})}),t()]).then(function(e){var r=_slicedToArray(e,3),t=r[0].enabled,n=r[1].showPrompt,o=r[2].status;a(t&&n&&o===m.ACCOUNT_NOT_FOUND)}).catch(function(){a(!1)})})},renderEmailValidationPage:function(e){var u=e.accountStatus,l=e.selector;require(["customer.components","dpz.template","marketconfig/dpz.lang.wowPlus"],function(e,r,t){var n=e.WowPlusEmailVerificationPage,o=e.TranslateContext,a=r.contextFixed,i=r.getTranslateContextValue,c=document.querySelector(l);preact.render(preact.h(o.Provider,{value:i(_objectSpread({},t))},preact.h(n,{jsDPZ:jsDPZ,urlConfig:urlConfig,contextFixed:a,accountStatus:u,isAccountCreated:u===m.ACCOUNT_ACTIVE})),c)})},sendEmail:c,showAccountCreationModal:function(){require(["confirmation.components","marketconfig/dpz.lang.customer","marketconfig/dpz.lang.wowPlus"],function(e,r,t){var n=e.TranslateContext,o=e.WowCreateAccountPromotionModal;preact.render(preact.h(n.Provider,{value:f(_objectSpread(_objectSpread({},r),t))},preact.h(o,{accountEmail:jsDPZ.app.customer.getCustomer().data.Email,accountStatuses:m,closeModal:function(){function e(){preact.render(null,document.querySelector(".js-modalContainer")),window.removeEventListener("link",e,!1),clearTimeout(r)}var r;window.addEventListener("link",e,!1),r=setTimeout(e,500)},preventClosing:!0,sendEmail:c,setProviderPreferences:u,site:site,template:a})),document.querySelector(".js-modalContainer"))})},verifyEmail:function(e){var o=e.token;return new Promise(function(e,r){if(i()){var t=jsDPZ.app.customer.getCustomer().data.CustomerID,n=void 0===t?"":t;jsDPZ.ajax.verifyEmailForWallet({provider:d,data:{customerId:n,token:o}}).then(e).fail(r)}else r(new Error(p))})}}});